{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// axios library\nimport axios from 'axios';\n\n// iziToast library\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\niziToast.settings({\n  position: 'topRight',\n  maxWidth: 300,\n  // timeout: 5000,\n  closeOnEscape: true,\n  closeOnClick: true,\n});\n\n// SimpleLightbox library\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst lightbox = new SimpleLightbox('.gallery-list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// Elements ojects\nconst elements = {\n  form: document.querySelector('.js-sumbit'),\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.js-loader'),\n  loaderWrap: document.querySelector('.js-loader-wrap'),\n  moreBtn: document.querySelector('.js-btn'),\n};\n\n// Variables\nlet wordSearch = '';\nlet currentPage = 1;\nlet perPage = 40;\nlet totalImg = 1;\nlet totalPages = 1;\n\n// Event listeners - submit to submit form\nelements.form.addEventListener('submit', handlerSubmitForm);\n\n// Event listeners - click to moreBtn\nelements.moreBtn.addEventListener('click', handlerMoreBtn);\n\n// Callback function for listener, for submitting a form\nasync function handlerSubmitForm(evt) {\n  evt.preventDefault();\n  currentPage = 1;\n  loaderSow();\n  moreBtnHidden();\n\n  const { searchQuery } = evt.currentTarget.elements;\n  const date = {\n    search: searchQuery.value,\n  };\n  wordSearch = date.search;\n\n  try {\n    await axiosSearch(wordSearch, currentPage, perPage).then(\n      ({ data, data: { hits }, data: { totalHits } }) => {\n        totalImg = totalHits;\n        totalPages = Math.ceil(totalImg / perPage);\n\n        if (hits.length === 0) {\n          iziToast.error({\n            message:\n              'Sorry, there are no images matching your search query. Please try again.',\n          });\n          moreBtnHidden();\n          currentPage = 1;\n        } else {\n          elements.gallery.innerHTML = createMarkup(hits);\n\n          moreBtnSow();\n        }\n        lightbox.refresh();\n        loaderHidden();\n      }\n    );\n  } catch (error) {\n    iziToast.error({\n      message: 'Oops! Something went wrong! Try reloading the page!',\n    });\n    loaderHidden();\n    console.log(error);\n  } finally {\n    evt.target.reset();\n  }\n}\n\n// Callback function for listener, for click at MoreBtn\nasync function handlerMoreBtn() {\n  currentPage += 1;\n\n  if (currentPage > totalPages) {\n    moreBtnHidden();\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n    return;\n  }\n  moreBtnHidden();\n  loaderSow();\n\n  try {\n    await axiosSearch(wordSearch, currentPage, perPage).then(\n      ({ data, data: { hits }, data: { totalHits } }) => {\n        elements.gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n        loaderHidden();\n        moreBtnSow();\n\n        lightbox.refresh();\n      }\n    );\n  } catch (error) {\n    iziToast.error({\n      message: 'Oops! Something went wrong! Try reloading the page!',\n    });\n    loaderHidden();\n    moreBtnSow();\n  }\n\n  // Card height\n  elements.galleryItem = document.querySelector('.js-gallery-item');\n  const heightItem = elements.galleryItem.getBoundingClientRect().height;\n\n  // window.scrollBy page scroll\n  window.scrollBy({\n    top: heightItem * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\n// Load and Error Handling Functions\nfunction loaderSow() {\n  elements.loader.classList.replace('hidden', 'show');\n  elements.loaderWrap.classList.replace('hidden', 'show');\n}\nfunction loaderHidden() {\n  elements.loader.classList.replace('show', 'hidden');\n  elements.loaderWrap.classList.replace('show', 'hidden');\n}\n\n// moreBtnSow, moreBtnHidden function\nfunction moreBtnSow() {\n  elements.moreBtn.classList.replace('hidden', 'show');\n}\nfunction moreBtnHidden() {\n  elements.moreBtn.classList.replace('show', 'hidden');\n}\n\n// request function\nasync function axiosSearch(word, currentPage, perPage) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '40988113-0969bce247b2af623dbb12295';\n\n  const config = {\n    params: {\n      key: API_KEY,\n      q: word,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: currentPage,\n      per_page: perPage,\n    },\n  };\n\n  const axiosResp = await axios.get(`${BASE_URL}`, config);\n  return axiosResp;\n}\n\n// markup function\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"js-gallery-item gallery-item\"><a class=\"gallery-link\" href=\"${largeImageURL}\"><img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" /></a>\n    <div class=\"gallery-wrapper\">\n      <div class=\"gallery-descr\">\n        <p class=\"gallery-subtitle\">Likes</p>\n        <p class=\"gallery-text\">${likes}</p>\n      </div>\n      <div class=\"gallery-descr\">\n        <p class=\"gallery-subtitle\">Views</p>\n        <p class=\"gallery-text\">${views}</p>\n      </div>\n      <div class=\"gallery-descr\">\n        <p class=\"gallery-subtitle\">Comments</p>\n        <p class=\"gallery-text\">${comments}</p>\n      </div>\n      <div class=\"gallery-descr\">\n        <p class=\"gallery-subtitle\">Downloads</p>\n        <p class=\"gallery-text\">${downloads}</p>\n      </div>\n    </div>\n  </li>`\n    )\n    .join('');\n}\n"],"names":["iziToast","lightbox","SimpleLightbox","elements","wordSearch","currentPage","perPage","totalImg","totalPages","handlerSubmitForm","handlerMoreBtn","evt","loaderSow","moreBtnHidden","searchQuery","axiosSearch","data","hits","totalHits","createMarkup","moreBtnSow","loaderHidden","error","heightItem","word","BASE_URL","config","axios","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}