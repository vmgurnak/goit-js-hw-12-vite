{"version":3,"file":"commonHelpers.js","sources":["../src/js/request-api.js","../src/js/markup.js","../src/js/main.js"],"sourcesContent":["import axios from 'axios';\n\n// default export\nexport default axiosSearch;\n\nasync function axiosSearch(word, currentPage, perPage) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '40988113-0969bce247b2af623dbb12295';\n\n  const config = {\n    params: {\n      key: API_KEY,\n      q: word,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: currentPage,\n      per_page: perPage,\n    },\n  };\n\n  const axiosResp = await axios.get(`${BASE_URL}`, config);\n  return axiosResp;\n}\n","// default export\nexport default createMarkup;\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"js-gallery-item gallery-item\"><a class=\"gallery-link\" href=\"${largeImageURL}\"><img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" /></a>\n    <div class=\"gallery-wrapper\">\n      <div class=\"gallery-descr\">\n        <p class=\"gallery-subtitle\">Likes</p>\n        <p class=\"gallery-text\">${likes}</p>\n      </div>\n      <div class=\"gallery-descr\">\n        <p class=\"gallery-subtitle\">Views</p>\n        <p class=\"gallery-text\">${views}</p>\n      </div>\n      <div class=\"gallery-descr\">\n        <p class=\"gallery-subtitle\">Comments</p>\n        <p class=\"gallery-text\">${comments}</p>\n      </div>\n      <div class=\"gallery-descr\">\n        <p class=\"gallery-subtitle\">Downloads</p>\n        <p class=\"gallery-text\">${downloads}</p>\n      </div>\n    </div>\n  </li>`\n    )\n    .join('');\n}\n","// Default export\nimport axiosSearch from './request-api';\nimport createMarkup from './markup';\n\n// iziToast library\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\niziToast.settings({\n  position: 'topRight',\n  maxWidth: 300,\n  // timeout: 5000,\n  closeOnEscape: true,\n  closeOnClick: true,\n});\n\n// SimpleLightbox library\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nconst lightbox = new SimpleLightbox('.gallery-list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// Elements ojects\nconst elements = {\n  form: document.querySelector('.js-sumbit'),\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.js-loader'),\n  loaderWrap: document.querySelector('.js-loader-wrap'),\n  moreBtn: document.querySelector('.js-btn'),\n};\n\n// Variables\nlet wordSearch = '';\nlet currentPage = 1;\nlet perPage = 3;\nlet totalImg = 1;\nlet totalPages = 1;\n\n// Event listeners - submit to submit form\nelements.form.addEventListener('submit', handlerSubmitForm);\n\n// Event listeners - click to moreBtn\nelements.moreBtn.addEventListener('click', handlerMoreBtn);\n\n// Callback function for listener, for submitting a form\nasync function handlerSubmitForm(evt) {\n  evt.preventDefault();\n  currentPage = 1;\n  loaderSow();\n  moreBtnHidden();\n\n  const { searchQuery } = evt.currentTarget.elements;\n  const date = {\n    search: searchQuery.value,\n  };\n  wordSearch = date.search;\n\n  try {\n    await axiosSearch(wordSearch, currentPage, perPage).then(\n      ({ data, data: { hits }, data: { totalHits } }) => {\n        totalImg = totalHits;\n        totalPages = Math.ceil(totalImg / perPage);\n\n        if (hits.length === 0) {\n          iziToast.error({\n            message:\n              'Sorry, there are no images matching your search query. Please try again.',\n          });\n          moreBtnHidden();\n          loaderHidden();\n          currentPage = 1;\n        } else {\n          elements.gallery.innerHTML = createMarkup(hits);\n\n          loaderHidden();\n          moreBtnSow();\n\n          lightbox.refresh();\n        }\n      }\n    );\n  } catch (error) {\n    iziToast.error({\n      message: 'Oops! Something went wrong! Try reloading the page!',\n    });\n    loaderHidden();\n    console.log(error);\n  } finally {\n    evt.target.reset();\n  }\n}\n\n// Callback function for listener, for click at MoreBtn\nasync function handlerMoreBtn() {\n  currentPage += 1;\n\n  if (currentPage > totalPages) {\n    moreBtnHidden();\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n    return;\n  }\n\n  moreBtnHidden();\n  loaderSow();\n\n  try {\n    await axiosSearch(wordSearch, currentPage, perPage).then(\n      ({ data, data: { hits }, data: { totalHits } }) => {\n        elements.gallery.insertAdjacentHTML('beforeend', createMarkup(hits));\n\n        loaderHidden();\n        moreBtnSow();\n\n        lightbox.refresh();\n      }\n    );\n  } catch (error) {\n    iziToast.error({\n      message: 'Oops! Something went wrong! Try reloading the page!',\n    });\n    loaderHidden();\n    moreBtnSow();\n  }\n\n  // Card height\n  elements.galleryItem = document.querySelector('.js-gallery-item');\n  const heightItem = elements.galleryItem.getBoundingClientRect().height;\n\n  // window.scrollBy page scroll\n  window.scrollBy({\n    top: heightItem * 2,\n    left: 0,\n    behavior: 'smooth',\n  });\n}\n\n// Load and Error Handling Functions\nfunction loaderSow() {\n  elements.loader.classList.replace('hidden', 'show');\n  elements.loaderWrap.classList.replace('hidden', 'show');\n}\nfunction loaderHidden() {\n  elements.loader.classList.replace('show', 'hidden');\n  elements.loaderWrap.classList.replace('show', 'hidden');\n}\n\n// moreBtnSow, moreBtnHidden function\nfunction moreBtnSow() {\n  elements.moreBtn.classList.replace('hidden', 'show');\n}\nfunction moreBtnHidden() {\n  elements.moreBtn.classList.replace('show', 'hidden');\n}\n"],"names":["axiosSearch","word","currentPage","perPage","BASE_URL","config","axios","createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","lightbox","SimpleLightbox","elements","wordSearch","totalImg","totalPages","handlerSubmitForm","handlerMoreBtn","evt","loaderSow","moreBtnHidden","searchQuery","data","hits","totalHits","loaderHidden","moreBtnSow","error","heightItem"],"mappings":"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"}